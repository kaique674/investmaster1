

<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InvestMaster Ultra - N√≠vel Avan√ßado</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg: #F8F9FA;
            --white: #FFFFFF;
            --primary: #1A252F; /* Cinza escuro profissional */
            --accent: #2980B9;
            --success: #27AE60;
            --danger: #E74C3C;
            --locked: #D5DBDB;
        }

        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; display: flex; overflow-x: hidden; color: #333; }

        /* Menu Lateral */
        #side-menu {
            width: 260px; height: 100vh; background: var(--primary); color: white;
            position: fixed; left: -260px; transition: 0.3s; z-index: 1000; padding: 25px 15px;
        }
        #side-menu.active { left: 0; }
        .menu-link { display: block; color: #BDC3C7; padding: 15px; text-decoration: none; border-bottom: 1px solid #2C3E50; cursor: pointer; transition: 0.2s; }
        .menu-link:hover { color: white; background: #2C3E50; border-radius: 8px; }

        #overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 999; }

        /* Layout */
        main { flex: 1; padding: 20px; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; }
        .container { background: var(--white); width: 100%; max-width: 550px; padding: 35px; border-radius: 25px; box-shadow: 0 15px 40px rgba(0,0,0,0.08); position: relative; margin-top: 40px; }

        #menu-btn { font-size: 28px; cursor: pointer; color: var(--primary); position: absolute; left: 20px; top: 20px; z-index: 500; }

        /* Cards de N√≠vel */
        .level-card {
            background: #fff; border: 2px solid #EDF2F7; border-radius: 18px; padding: 22px;
            margin-bottom: 18px; cursor: pointer; display: flex; align-items: center; justify-content: space-between;
            transition: 0.3s;
        }
        .level-card:hover:not(.locked) { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.05); border-color: var(--accent); }
        .level-card.locked { opacity: 0.5; cursor: not-allowed; background: #F2F4F4; }
        .level-card.completed { border-color: var(--success); background: #F0FFF4; }

        /* Jogo */
        .box { background: #F8FAFC; border: 1px solid #E2E8F0; padding: 20px; border-radius: 15px; margin: 20px 0; font-size: 14px; line-height: 1.6; }
        .label-t { color: #2D3748; font-weight: 800; font-size: 11px; text-transform: uppercase; letter-spacing: 1px; display: block; margin-bottom: 5px; }
        .label-i { color: var(--success); font-weight: 700; display: block; margin-top: 15px; font-size: 11px; text-transform: uppercase; }
        
        button.opt { width: 100%; padding: 18px; margin: 10px 0; border: 2px solid #EDF2F7; border-radius: 12px; background: white; font-weight: 600; cursor: pointer; text-align: left; transition: 0.2s; }
        button.opt:hover { border-color: var(--accent); }
        button.opt.selected { background: var(--accent); color: white; border-color: var(--accent); }
        
        .hidden { display: none; }
        .btn-main { width: 100%; padding: 18px; background: var(--primary); color: white; border: none; border-radius: 12px; font-weight: 700; cursor: pointer; margin-top: 15px; font-size: 16px; }
    </style>
</head>
<body>

<div id="side-menu">
    <h2 style="padding-left: 15px;">InvestMaster üíé</h2>
    <div class="menu-link" onclick="mostrarTela('home')">üè† Trilha de N√≠veis</div>
    <div class="menu-link" onclick="mostrarTela('progresso')">üìà Estat√≠sticas</div>
    <div class="menu-link" onclick="limparHistorico()" style="color: #E74C3C; margin-top: 50px;">üóëÔ∏è Resetar Tudo</div>
</div>
<div id="overlay" onclick="toggleMenu()"></div>

<main>
    <div id="menu-btn" onclick="toggleMenu()">‚ò∞</div>
    
    <div class="container">
        <div id="tela-home">
            <h2 style="margin-bottom: 30px; text-align: center;">Sua Jornada</h2>
            <div id="lista-niveis"></div>
        </div>

        <div id="tela-jogo" class="hidden">
            <h3 id="game-title" style="margin: 0; color: var(--accent);"></h3>
            <div id="icon-display" style="font-size: 65px; text-align: center; margin: 15px 0;"></div>
            <div class="box">
                <span class="label-t">Defini√ß√£o T√©cnica</span>
                <div id="txt-tecnico"></div>
                <span class="label-i">Traduzindo</span>
                <div id="txt-informal"></div>
            </div>
            <p style="font-weight: 700;">Pergunta da Prova:</p>
            <p id="game-question" style="color: #4A5568;"></p>
            <div id="game-options"></div>
            <button id="btn-confirmar" class="btn-main hidden" onclick="confirmarResposta()">Confirmar Resposta</button>
        </div>

        <div id="tela-resultado" class="hidden" style="text-align: center;">
            <div id="resultado-content"></div>
        </div>

        <div id="tela-progresso" class="hidden">
            <h2 style="text-align: center;">Desempenho Acad√™mico</h2>
            <canvas id="progressoChart"></canvas>
            <button class="btn-main" onclick="mostrarTela('home')">Voltar ao In√≠cio</button>
        </div>
    </div>
</main>

<script>
    const trilha = [
        {
            id: 1, nome: "N√≠vel 1: Renda Fixa Base", status: "unlocked",
            fases: [
                { t: "CDB", e: "üè¶", tecnico: "Certificado de Dep√≥sito Banc√°rio. T√≠tulo de d√≠vida privada para financiamento banc√°rio.", informal: "√â voc√™ emprestando dinheiro pro banco. Em troca, ele te devolve com juros.", q: "Qual a garantia principal do CDB para valores at√© 250 mil?", o: ["Fundo Garantidor de Cr√©ditos (FGC)", "Seguro de Vida"], c: 0 },
                { t: "Tesouro Selic", e: "üáßüá∑", tecnico: "T√≠tulo p√∫blico p√≥s-fixado indexado √† taxa b√°sica de juros.", informal: "O investimento mais seguro. Se a taxa Selic sobe, seu rendimento sobe junto.", q: "√â ideal para qual finalidade?", o: ["Reserva de Emerg√™ncia", "Apostar em startups"], c: 0 }
            ]
        },
        {
            id: 2, nome: "N√≠vel 2: Renda Vari√°vel", status: "locked",
            fases: [
                { t: "A√ß√µes", e: "üìä", tecnico: "Menor fra√ß√£o do capital social de uma empresa, conferindo direito a voto ou lucros.", informal: "Voc√™ vira s√≥cio da empresa. Se ela lucrar, voc√™ recebe sua parte em dinheiro.", q: "Como se chama o lucro pago aos acionistas?", o: ["Dividendos", "Comiss√£o"], c: 0 },
                { t: "FIIs", e: "üè¢", tecnico: "Comunh√£o de recursos destinados √† aplica√ß√£o em ativos do setor imobili√°rio.", informal: "Um grupo que compra shoppings e galp√µes. Voc√™ ganha alugu√©is todo m√™s sem ter im√≥vel.", q: "O lucro dos FIIs para pessoas f√≠sicas costuma ser:", o: ["Isento de Imposto de Renda", "Tributado em 50%"], c: 0 }
            ]
        },
        {
            id: 3, nome: "N√≠vel 3: Avan√ßado (Expert)", status: "locked",
            fases: [
                { t: "Marca√ß√£o a Mercado", e: "üé¢", tecnico: "Atualiza√ß√£o do valor de um ativo de renda fixa pelo pre√ßo de negocia√ß√£o atual no mercado secund√°rio.", informal: "O pre√ßo do seu t√≠tulo varia todo dia. Se voc√™ vender antes do prazo, pode ganhar muito ou perder dinheiro dependendo dos juros atuais.", q: "Se as taxas de juros do mercado CAEM, o que acontece com o pre√ßo de um t√≠tulo pr√©-fixado?", o: ["O pre√ßo do t√≠tulo SOBE", "O pre√ßo do t√≠tulo CAI"], c: 0 },
                { t: "Derivativos (Op√ß√µes)", e: "‚ö°", tecnico: "Contratos cujo valor deriva de um ativo subjacente (a√ß√µes, d√≥lar, etc) em data futura.", informal: "√â como um seguro ou uma aposta. Voc√™ compra o 'direito' de comprar ou vender algo por um pre√ßo fixo no futuro.", q: "Qual o principal uso dos derivativos para grandes investidores?", o: ["Hedge (Prote√ß√£o de carteira)", "Ganhar pontos no cart√£o"], c: 0 }
            ]
        }
    ];

    let nivelAtual = 0; let faseAtual = 0; let acertosNivel = 0;
    let escolha = null; let progressoScores = JSON.parse(localStorage.getItem('progresso')) || [];

    function toggleMenu() {
        document.getElementById('side-menu').classList.toggle('active');
        document.getElementById('overlay').style.display = document.getElementById('side-menu').classList.contains('active') ? 'block' : 'none';
    }

    function mostrarTela(id) {
        ['tela-home', 'tela-jogo', 'tela-resultado', 'tela-progresso'].forEach(t => document.getElementById(t).classList.add('hidden'));
        document.getElementById('tela-' + id).classList.remove('hidden');
        if(id === 'home') renderMenu();
        if(id === 'progresso') renderGrafico();
        if(document.getElementById('side-menu').classList.contains('active')) toggleMenu();
    }

    function renderMenu() {
        const lista = document.getElementById('lista-niveis');
        lista.innerHTML = "";
        trilha.forEach((n, i) => {
            const card = document.createElement('div');
            card.className = `level-card ${n.status}`;
            card.innerHTML = `<div><small>M√≥dulo 0${n.id}</small><br><strong>${n.nome}</strong></div> <span>${n.status === 'locked' ? 'üîí' : (n.status === 'completed' ? 'üéì' : 'üöÄ')}</span>`;
            if(n.status !== 'locked') card.onclick = () => iniciarNivel(i);
            lista.appendChild(card);
        });
    }

    function iniciarNivel(i) {
        nivelAtual = i; faseAtual = 0; acertosNivel = 0;
        mostrarTela('jogo');
        renderFase();
    }

    function renderFase() {
        const f = trilha[nivelAtual].fases[faseAtual];
        document.getElementById('game-title').innerText = f.t;
        document.getElementById('icon-display').innerText = f.e;
        document.getElementById('txt-tecnico').innerText = f.tecnico;
        document.getElementById('txt-informal').innerText = f.informal;
        document.getElementById('game-question').innerText = f.q;
        const opts = document.getElementById('game-options');
        opts.innerHTML = "";
        f.o.forEach((txt, i) => {
            const b = document.createElement('button');
            b.className = 'opt';
            b.innerText = txt;
            b.onclick = () => {
                escolha = i;
                Array.from(opts.children).forEach(el => el.classList.remove('selected'));
                b.classList.add('selected');
                document.getElementById('btn-confirmar').classList.remove('hidden');
            };
            opts.appendChild(b);
        });
    }

    function confirmarResposta() {
        if(escolha === trilha[nivelAtual].fases[faseAtual].c) acertosNivel++;
        faseAtual++; escolha = null;
        document.getElementById('btn-confirmar').classList.add('hidden');
        if(faseAtual < trilha[nivelAtual].fases.length) renderFase();
        else finalizarNivel();
    }

    function finalizarNivel() {
        mostrarTela('resultado');
        const total = trilha[nivelAtual].fases.length;
        const passou = acertosNivel === total;
        let html = `<div style="font-size: 60px;">${passou ? 'üìú' : '‚ö†Ô∏è'}</div>`;
        html += `<h2>${passou ? 'Diploma Conquistado!' : 'Quase l√°!'}</h2>`;
        html += `<p>Voc√™ acertou ${acertosNivel} de ${total}.</p>`;
        
        if(passou) {
            trilha[nivelAtual].status = 'completed';
            if(trilha[nivelAtual+1]) trilha[nivelAtual+1].status = 'unlocked';
            progressoScores.push(100);
            html += `<p>Excelente! Voc√™ dominou este m√≥dulo e o pr√≥ximo foi liberado.</p>`;
        } else {
            progressoScores.push(Math.round((acertosNivel/total)*100));
            html += `<p style="color: var(--danger)">Precisamos de 100% de acerto para o diploma. Revise os conceitos!</p>`;
        }
        localStorage.setItem('progresso', JSON.stringify(progressoScores));
        html += `<button class="btn-main" onclick="mostrarTela('home')">Menu Principal</button>`;
        document.getElementById('resultado-content').innerHTML = html;
    }

    function renderGrafico() {
        const ctx = document.getElementById('progressoChart').getContext('2d');
        if(window.myChart) window.myChart.destroy();
        window.myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: progressoScores.map((_, i) => `Desafio ${i+1}`),
                datasets: [{ label: 'Performance (%)', data: progressoScores, borderColor: '#2980B9', backgroundColor: 'rgba(41, 128, 185, 0.1)', fill: true, tension: 0.4 }]
            },
            options: { scales: { y: { beginAtZero: true, max: 100 } } }
        });
    }

    function limparHistorico() { if(confirm("Deseja apagar seu progresso?")) { localStorage.clear(); location.reload(); } }

    renderMenu();
</script>
</body>
</html>